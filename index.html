<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MEU ESPAÇO TERAPÊUTICO</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#007acc">

<style>
body {
  font-family: Arial;
  font-size: 12px;
  margin:0;
  min-height:100vh;
  background:#f0f8ff;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

h2 {
  font-size:20px;
  text-transform:uppercase;
  color:#007acc;
  margin-bottom:20px;
}

.container {
  display:flex;
  flex-direction:column;
  gap:20px;
  align-items:center;
  width:95%;
  max-width:400px;
}

form {
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
  width:100%;
  display:flex;
  flex-direction:column;
}

textarea, input[type="text"], .emocoes-list button {
  width:100%;
  padding:10px;
  font-size:12px;
  border-radius:5px;
  border:1px solid #ccc;
  margin-bottom:10px;
}

textarea { height:150px; resize:vertical; }

.emocoes-list {
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:5px;
  max-height:200px;
  overflow-y:auto;
  border:1px solid #ccc;
  padding:5px;
  border-radius:5px;
}

.emocoes-list button {
  cursor:pointer;
  background:#fff;
  border:1px solid #007acc;
  color:#007acc;
}

.emocoes-list button.selected {
  background:#007acc;
  color:#fff;
}

button {
  margin-top:15px;
  border:none;
  background:#007acc;
  color:#fff;
  cursor:pointer;
  font-size:12px;
  border-radius:5px;
  padding:10px;
}

#resultado {
  padding:15px;
  background:#e6f7ff;
  border-radius:10px;
  width:100%;
  min-height:200px;
}

.resultado-item { margin-bottom:10px; }

/* ================= MODO COSMOS ================= */

#cosmosViewport {
  position:fixed;
  inset:0;
  background:#000;
  overflow:auto;
}

#cosmosWorld {
  position:relative;
  width:10000px;
  height:10000px;
  transform-origin: 0 0;
}

.cosmos-item {
  position:absolute;
  background:rgba(1,1,20,0.75);
  color:#e6f7ff;
  padding:10px;
  border-radius:8px;
  max-width:300px;
  font-size:12px;
  box-shadow:0 0 10px rgba(0,0,0,0.5);
}

#cosmosControls {
  position:fixed;
  bottom:15px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:9999;
}

#cosmosControls button {
  background:#007acc;
  padding:8px 12px;
  font-size:12px;
}
</style>
</head>

<body>
<div class="container" id="mainContainer">
<h2>MEU ESPAÇO TERAPÊUTICO</h2>

<form>
<textarea id="meuRelato" placeholder="Escreva aqui como você está se sentindo..."></textarea>
<input type="text" id="palavraMomento" placeholder="Palavra do momento">
<div class="emocoes-list" id="emocoesList">
<button type="button">Alegria</button><button type="button">Tristeza</button>
<button type="button">Raiva</button><button type="button">Medo</button>
<button type="button">Amor</button><button type="button">Calma</button>
<button type="button">Ansiedade</button><button type="button">Esperança</button>
</div>
</form>

<form id="queroSentirForm">
<input type="text" id="queroSentirInput" placeholder="Quero sentir que...">
<button type="submit">Ressignificar</button>
<button type="button" id="modoCosmosBtn">Modo Cosmos</button>
</form>

<div id="resultado"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCwOpPBMXNNjteuSaSUdnQnrn1v20SW6Ao",
  authDomain: "meu-espaco-terapeutico.firebaseapp.com",
  projectId: "meu-espaco-terapeutico"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const cosmosRef = db.collection('modoCosmos');

function escapeHtml(str){
  return String(str).replace(/&/g,'&amp;')
    .replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;').replace(/'/g,'&#39;')
    .replace(/\n/g,'<br>');
}

document.getElementById('modoCosmosBtn').addEventListener('click', ()=>{
  document.body.innerHTML = `
    <div id="cosmosViewport">
      <div id="cosmosWorld"></div>
    </div>

    <div id="cosmosControls">
      <button id="zoomOut">−</button>
      <button id="zoomIn">+</button>
      <button id="sairCosmos">Sair</button>
    </div>
  `;

  const world = document.getElementById('cosmosWorld');
  let scale = 1;

  cosmosRef.orderBy('timestamp').get().then(snapshot=>{
    snapshot.forEach(()=>{
      const div = document.createElement('div');
      div.className = 'cosmos-item';
      div.innerHTML = `
        <strong>Relato coletivo</strong><br><br>
        Um fragmento emocional compartilhado.
      `;
      div.style.left = Math.random()*9500 + 'px';
      div.style.top  = Math.random()*9500 + 'px';
      world.appendChild(div);
    });
  });

  document.getElementById('zoomIn').onclick = ()=>{
    scale += 0.1;
    world.style.transform = `scale(${scale})`;
  };

  document.getElementById('zoomOut').onclick = ()=>{
    scale = Math.max(0.2, scale - 0.1);
    world.style.transform = `scale(${scale})`;
  };

  document.getElementById('sairCosmos').onclick = ()=>location.reload();
});
</script>
</body>
</html>
